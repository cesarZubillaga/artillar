extends base.pug
block content
  div(ng-controller="TestsController")
   div(class="row", ng-init="init()")
    div(class="col-xs-12 form-inline")
     form(class="form-group")
       div(class="checkbox")
        label
         input(type="checkbox", ng-model="css.concurrency", ng-click="putCssConfiguration()")
         | Concurrency
       div(class="checkbox")
        label
         input(type="checkbox", ng-model="css.latency.bar", ng-click="putCssConfiguration()")
         | Latency (bars)
       div(class="checkbox")
        label
         input(type="checkbox", ng-model="css.latency.radar", ng-click="putCssConfiguration()")
         | Latency (radar)
       div(class="checkbox")
        label
         input(type="checkbox", ng-model="css.table", ng-click="putCssConfiguration()")
         | Table
       div(class="checkbox")
        label
         input(type="checkbox", ng-model="css.wide", ng-click="putCssConfiguration()")
         | Hide list of tests
    div(class="col-xs-3")
     h2(ng-show="css.wide == false")="List of runned tests"
     p(ng-show="tests.length<=0")="No tests available"
     table(class="table table-striped", ng-show="tests.length>0 && css.wide == false")
      caption="List of Tests"
      tr
       th="Name"
       th="Action"
      tr(ng-repeat="test in tests")
       td {{test}}
       td
        button(class="btn btn-success", ng-disabled="shownTests.indexOf(test) >= 0", ng-click="getStats(test)")
         i(class="glyphicon glyphicon-plus")
        br
        button(class="btn btn-danger", ng-click="removeFile(test)")
         i(class="glyphicon glyphicon-trash")
        br
        button(class="btn btn-default", ng-click="remove(test)")
         i(class="glyphicon glyphicon-remove")
        br
    div(ng-class="{'col-xs-12': css.wide, 'col-xs-9': css.wide == false}")
     h2="Global Stats"
     p(ng-show="shownTests.length<=0")="Click on the + of the list of tests that have been runned"
     div(ng-class="{'col-xs-4': css.wide}", ng-show="css.latency.bar && latency.data.length")
      h4="Global Latency(ms)"
      canvas(id="bar", class="chart chart-bar", chart-data="latency.data", chart-labels="latency.labels", chart-series="latency.series")
     div(ng-class="{'col-xs-4': css.wide}", ng-show="css.concurrency && concurrency.data.length")
      h4="Concurrency of Users"
      canvas(id="line", class="chart chart-line", chart-data="concurrency.data", chart-labels="concurrency.labels", chart-series="concurrency.series", cart-options="options", chart-dataset-override="datasetOverride")
     div(ng-class="{'col-xs-4': css.wide}", ng-show="css.latency.radar && latency.data.length")
      h4="Global Latency(ms)"
      canvas(id="radar", class="chart chart-radar", chart-data="latency.data", chart-options="options", chart-labels="latency.labels")
     table(class="table  table-striped", ng-show="css.table && shownTests.length")
      tr
       th="Test"
       th="Arrival Rate"
       th="Duration"
       th="Total Users"
       th="Max"
       th="Median"
       th="Min"
       th="p95"
       th="p99"
       th(style="min-width: 100px")="CODES"
       th="Created at"
      tr(ng-repeat="(key, value) in stats")
       td {{key}}
       td {{value.arrivalRate}}
       td {{value.duration}}
       td {{value.totalUsers}}
       td {{value.max}}
       td {{value.median}}
       td {{value.min}}
       td {{value.p95}}
       td {{value.p99}}
       td
        span(ng-repeat="(key, value) in value.codes") {{key}} - {{value}}
         br
       td {{value.createdAt|date:'medium'}}